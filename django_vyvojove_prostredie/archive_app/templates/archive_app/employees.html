{% extends 'archive_app/index.html' %}
{% load static %}
{% block content %}
<section class="content">
    <!-- Header Section -->
    <link rel="stylesheet" href="{%  static 'archive_app/list.css' %}">

    <section class="header2">
        <h1 class="title">Umelci a spolupracovníci</h1>
        {% if user.is_authenticated %}
            <a href="/employees/add_employee/" class="btn">Pridať osobu</a>
        {% endif %}
    </section>

    <!-- Filters Section -->
    <section class="filters">
        <div class="filter">
            <label for="abecedne">Abecedne</label>
            <select id="abecedne" class="dropdown">
                <option>Od a po z</option>
                <option>Od z po a</option>
            </select>
        </div>
        <div class="filter">
            <label for="meno">Meno</label>
            <select id="meno" class="dropdown">
                <option>-</option>
            </select>
        </div>
        <div class="filter">
            <label for="subor">Súbor</label>
            <select id="subor" class="dropdown">
                <option>-</option>
            </select>
        </div>
        <div class="filter">
            <label for="rola">Rola</label>
            <select id="rola" class="dropdown">
                <option>-</option>
            </select>
        </div>
        <form class="filters" id="search-form" method="get" action="{% url 'list_employees' %}">
            <div class="filter">
                <label for="zverejnene">Zverejnené</label>
                <select id="zverejnene" class="dropdown" name="publicity">
                    <option value="">-</option>
                    <option value="true">Zverejnené</option>
                    <option value="false">Nezverejnené</option>
                </select>
            </div>
        
        <div class="filter search">
            <label for="key-term">Kľúčový pojem</label>
            <input id="key-term" type="text" class="search-input" placeholder="Sem napíš pojem">
        </div>
        <div class="filter">
            <button class="btn " id="search-button" type="submit">Vyhľadať</button>
        </div>
    </form>
    </section>

    <!-- Results Section -->
    <section class="results">
        {% for e in employees %}
            <div><a href="{% url 'get_employee' e.id %}" class="item"> {{ e.first_name }} {{ e.last_name }} </a></div>
        {% endfor %}
        <p class="results-text">Nájdených {{ employees.count }} záznamov.</p>
    </section>
</section>


<script>
document.getElementById("search-button").addEventListener("click", function() {
    const publicity = document.getElementById("zverejnene").value;
    fetch(`/search_employees?publicity=${publicity}`)
        .then(response => response.json())
        .then(data => {
            const resultsContainer = document.getElementById("results-container");
            resultsContainer.innerHTML = "";
            data.forEach(entry => {
                const div = document.createElement("div");
                div.textContent = `${entry.first_name} ${entry.last_name}`;
                resultsContainer.appendChild(div);
            });
        });
});
</script>
{% endblock %}